////  GotoSettingTools.m//  ToolsDemo////  Created by pengweijian on 2017/8/29.//  Copyright © 2017年 pengweijian. All rights reserved.//#import "GotoSettingTools.h"#import <UIKit/UIKit.h>#define UIAppCanOpenURL(url) [[UIApplication sharedApplication] canOpenURL:url]#define UIAppOpenURL(url) [[UIApplication sharedApplication] openURL:url]#define isIOSLater(sysVersion) ([UIDevice currentDevice].systemVersion.floatValue >= (sysVersion))// "App-Prefs:root"   混淆字符串，防止蛋疼的苹果审核吧static const unsigned char PREFIX[] = {0x41, 0x70, 0x70, 0x2d, 0x50, 0x72, 0x65, 0x66, 0x73, 0x3a, 0x72, 0x6f, 0x6f, 0x74, 0x0};@interface GotoSettingTools ()@property (nonatomic, strong) NSArray<NSString *> *settings;@end@implementation GotoSettingToolsSingleImplementation(Tools)- (NSArray<NSString *> *)settings{    if (!_settings) {        _settings = [NSArray arrayWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"setting.plist" ofType:nil]];    }    return _settings;}- (void)jumpToSettingType:(SettingType)type{    if (type < 0 || type > self.settings.count - 1) return;    NSString *path = self.settings[type];    NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"prefs:root=%@",path]];        if (UIAppCanOpenURL(url)) {        UIAppOpenURL(url);    }else{        if (!isIOSLater(8.0)) return;         // 混淆字符串，防止蛋疼的苹果审核吧//        unsigned char prefs[] = {0x41, 0x70, 0x70, 0x2d, 0x50, 0x72, 0x65, 0x66, 0x73,0x3a, 0x72, 0x6f, 0x6f, 0x74, 0x0};        NSString *prefix = [[NSString alloc] initWithBytes:PREFIX length:sizeof(PREFIX)/sizeof(PREFIX[0])-1 encoding:NSASCIIStringEncoding];        NSLog(@"%@---",prefix);                if (type == SettingTypeSettings) {            url = [NSURL URLWithString:UIApplicationOpenSettingsURLString];        }else{            url = [NSURL URLWithString:[NSString stringWithFormat:@"%@=%@",prefix,path]];        }                if (isIOSLater(10.0)) {            [[UIApplication sharedApplication] openURL:url options:[NSDictionary dictionary] completionHandler:^(BOOL success) {                NSLog(@"%zd",success);            }];        }else{            UIAppOpenURL(url);        }    }}@end